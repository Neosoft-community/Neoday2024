class N{constructor(e){this.properties=e??[]}get(e){const t=this.properties.filter(s=>s.name===e).map(s=>s.value);if(t.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(t.length!==0)return t[0]}getString(e){return this.getByType(e,"string")}getNumber(e){return this.getByType(e,"number")}getBoolean(e){return this.getByType(e,"boolean")}getByType(e,t){const s=this.get(e);if(s!==void 0){if(t!=="json"&&typeof s!==t)throw new Error('Expected property "'+e+'" to have type "'+t+'"');return s}}mustGetString(e){return this.mustGetByType(e,"string")}mustGetNumber(e){return this.mustGetByType(e,"number")}mustGetBoolean(e){return this.mustGetByType(e,"boolean")}mustGetByType(e,t){const s=this.get(e);if(s===void 0)throw new Error('Property "'+e+'" is missing');if(t!=="json"&&typeof s!==t)throw new Error('Expected property "'+e+'" to have type "'+t+'"');return s}getType(e){const t=this.properties.filter(s=>s.name===e).map(s=>s.type);if(t.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(t.length!==0)return t[0]}}const z="https://unpkg.com/@workadventure/scripting-api-extra@1.4.6/dist";class le{constructor(e){this.name=e.name,this.x=e.x,this.y=e.y,this.properties=new N(e.properties)}get isReadable(){const e=this.properties.getString("readableBy");return e?WA.player.tags.includes(e):!0}get isWritable(){const e=this.properties.getString("writableBy");return e?WA.player.tags.includes(e):!0}}function H(a){const e=a?"#"+a.join():"";WA.nav.openCoWebSite(z+"/configuration.html"+e)}async function ue(a,e){const t=await WA.room.getTiledMap(),s=new Map;return ee(t.layers,s,a,e),s}function ee(a,e,t,s){for(const r of a)if(r.type==="objectgroup"){for(const n of r.objects)if(n.type==="variable"||n.class==="variable"){if(t&&r.name!==t||s&&!s.includes(n.name))continue;e.set(n.name,new le(n))}}else r.type==="group"&&ee(r.layers,e,t,s)}let G;async function j(){return G===void 0&&(G=pe()),G}async function pe(){return ce(await WA.room.getTiledMap())}function ce(a){const e=new Map;return te(a.layers,"",e),e}function te(a,e,t){for(const s of a)s.type==="group"?te(s.layers,e+s.name+"/",t):(s.name=e+s.name,t.set(s.name,s))}async function fe(){const a=await j(),e=[];for(const t of a.values())if(t.type==="objectgroup")for(const s of t.objects)(s.type==="area"||s.class==="area")&&e.push(s);return e}function me(a){let e=1/0,t=1/0,s=0,r=0;const n=a.data;if(typeof n=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let o=0;o<a.height;o++)for(let i=0;i<a.width;i++)n[i+o*a.width]!==0&&(e=Math.min(e,i),r=Math.max(r,i),t=Math.min(t,o),s=Math.max(s,o));return{top:t,left:e,right:r+1,bottom:s+1}}function ae(a){let e=1/0,t=1/0,s=0,r=0;for(const n of a){const o=me(n);o.left<e&&(e=o.left),o.top<t&&(t=o.top),o.right>r&&(r=o.right),o.bottom>s&&(s=o.bottom)}return{top:t,left:e,right:r,bottom:s}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var de=Object.prototype.toString,k=Array.isArray||function(e){return de.call(e)==="[object Array]"};function F(a){return typeof a=="function"}function be(a){return k(a)?"array":typeof a}function O(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function K(a,e){return a!=null&&typeof a=="object"&&e in a}function he(a,e){return a!=null&&typeof a!="object"&&a.hasOwnProperty&&a.hasOwnProperty(e)}var ge=RegExp.prototype.test;function ye(a,e){return ge.call(a,e)}var Ae=/\S/;function We(a){return!ye(Ae,a)}var ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Pe(a){return String(a).replace(/[&<>"'`=\/]/g,function(t){return ve[t]})}var Se=/\s*/,we=/\s+/,Z=/\s*=/,Te=/\s*\}/,Ee=/#|\^|\/|>|\{|&|=|!/;function ke(a,e){if(!a)return[];var t=!1,s=[],r=[],n=[],o=!1,i=!1,p="",f=0;function b(){if(o&&!i)for(;n.length;)delete r[n.pop()];else n=[];o=!1,i=!1}var W,P,B;function L(w){if(typeof w=="string"&&(w=w.split(we,2)),!k(w)||w.length!==2)throw new Error("Invalid tags: "+w);W=new RegExp(O(w[0])+"\\s*"),P=new RegExp("\\s*"+O(w[1])),B=new RegExp("\\s*"+O("}"+w[1]))}L(e||A.tags);for(var c=new x(a),S,g,v,q,V,T;!c.eos();){if(S=c.pos,v=c.scanUntil(W),v)for(var R=0,ie=v.length;R<ie;++R)q=v.charAt(R),We(q)?(n.push(r.length),p+=q):(i=!0,t=!0,p+=" "),r.push(["text",q,S,S+1]),S+=1,q===`
`&&(b(),p="",f=0,t=!1);if(!c.scan(W))break;if(o=!0,g=c.scan(Ee)||"name",c.scan(Se),g==="="?(v=c.scanUntil(Z),c.scan(Z),c.scanUntil(P)):g==="{"?(v=c.scanUntil(B),c.scan(Te),c.scanUntil(P),g="&"):v=c.scanUntil(P),!c.scan(P))throw new Error("Unclosed tag at "+c.pos);if(g==">"?V=[g,v,S,c.pos,p,f,t]:V=[g,v,S,c.pos],f++,r.push(V),g==="#"||g==="^")s.push(V);else if(g==="/"){if(T=s.pop(),!T)throw new Error('Unopened section "'+v+'" at '+S);if(T[1]!==v)throw new Error('Unclosed section "'+T[1]+'" at '+S)}else g==="name"||g==="{"||g==="&"?i=!0:g==="="&&L(v)}if(b(),T=s.pop(),T)throw new Error('Unclosed section "'+T[1]+'" at '+c.pos);return qe(Le(r))}function Le(a){for(var e=[],t,s,r=0,n=a.length;r<n;++r)t=a[r],t&&(t[0]==="text"&&s&&s[0]==="text"?(s[1]+=t[1],s[3]=t[3]):(e.push(t),s=t));return e}function qe(a){for(var e=[],t=e,s=[],r,n,o=0,i=a.length;o<i;++o)switch(r=a[o],r[0]){case"#":case"^":t.push(r),s.push(r),t=r[4]=[];break;case"/":n=s.pop(),n[5]=r[2],t=s.length>0?s[s.length-1][4]:e;break;default:t.push(r)}return e}function x(a){this.string=a,this.tail=a,this.pos=0}x.prototype.eos=function(){return this.tail===""};x.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var s=t[0];return this.tail=this.tail.substring(s.length),this.pos+=s.length,s};x.prototype.scanUntil=function(e){var t=this.tail.search(e),s;switch(t){case-1:s=this.tail,this.tail="";break;case 0:s="";break;default:s=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=s.length,s};function E(a,e){this.view=a,this.cache={".":this.view},this.parent=e}E.prototype.push=function(e){return new E(e,this)};E.prototype.lookup=function(e){var t=this.cache,s;if(t.hasOwnProperty(e))s=t[e];else{for(var r=this,n,o,i,p=!1;r;){if(e.indexOf(".")>0)for(n=r.view,o=e.split("."),i=0;n!=null&&i<o.length;)i===o.length-1&&(p=K(n,o[i])||he(n,o[i])),n=n[o[i++]];else n=r.view[e],p=K(r.view,e);if(p){s=n;break}r=r.parent}t[e]=s}return F(s)&&(s=s.call(this.view)),s};function h(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}h.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};h.prototype.parse=function(e,t){var s=this.templateCache,r=e+":"+(t||A.tags).join(":"),n=typeof s<"u",o=n?s.get(r):void 0;return o==null&&(o=ke(e,t),n&&s.set(r,o)),o};h.prototype.render=function(e,t,s,r){var n=this.getConfigTags(r),o=this.parse(e,n),i=t instanceof E?t:new E(t,void 0);return this.renderTokens(o,i,s,e,r)};h.prototype.renderTokens=function(e,t,s,r,n){for(var o="",i,p,f,b=0,W=e.length;b<W;++b)f=void 0,i=e[b],p=i[0],p==="#"?f=this.renderSection(i,t,s,r,n):p==="^"?f=this.renderInverted(i,t,s,r,n):p===">"?f=this.renderPartial(i,t,s,n):p==="&"?f=this.unescapedValue(i,t):p==="name"?f=this.escapedValue(i,t,n):p==="text"&&(f=this.rawValue(i)),f!==void 0&&(o+=f);return o};h.prototype.renderSection=function(e,t,s,r,n){var o=this,i="",p=t.lookup(e[1]);function f(P){return o.render(P,t,s,n)}if(p){if(k(p))for(var b=0,W=p.length;b<W;++b)i+=this.renderTokens(e[4],t.push(p[b]),s,r,n);else if(typeof p=="object"||typeof p=="string"||typeof p=="number")i+=this.renderTokens(e[4],t.push(p),s,r,n);else if(F(p)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");p=p.call(t.view,r.slice(e[3],e[5]),f),p!=null&&(i+=p)}else i+=this.renderTokens(e[4],t,s,r,n);return i}};h.prototype.renderInverted=function(e,t,s,r,n){var o=t.lookup(e[1]);if(!o||k(o)&&o.length===0)return this.renderTokens(e[4],t,s,r,n)};h.prototype.indentPartial=function(e,t,s){for(var r=t.replace(/[^ \t]/g,""),n=e.split(`
`),o=0;o<n.length;o++)n[o].length&&(o>0||!s)&&(n[o]=r+n[o]);return n.join(`
`)};h.prototype.renderPartial=function(e,t,s,r){if(s){var n=this.getConfigTags(r),o=F(s)?s(e[1]):s[e[1]];if(o!=null){var i=e[6],p=e[5],f=e[4],b=o;p==0&&f&&(b=this.indentPartial(o,f,i));var W=this.parse(b,n);return this.renderTokens(W,t,s,b,r)}}};h.prototype.unescapedValue=function(e,t){var s=t.lookup(e[1]);if(s!=null)return s};h.prototype.escapedValue=function(e,t,s){var r=this.getConfigEscape(s)||A.escape,n=t.lookup(e[1]);if(n!=null)return typeof n=="number"&&r===A.escape?String(n):r(n)};h.prototype.rawValue=function(e){return e[1]};h.prototype.getConfigTags=function(e){return k(e)?e:e&&typeof e=="object"?e.tags:void 0};h.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!k(e))return e.escape};var A={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(a){C.templateCache=a},get templateCache(){return C.templateCache}},C=new h;A.clearCache=function(){return C.clearCache()};A.parse=function(e,t){return C.parse(e,t)};A.render=function(e,t,s,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+be(e)+'" was given as the first argument for mustache#render(template, view, partials)');return C.render(e,t,s,r)};A.escape=Pe;A.Scanner=x;A.Context=E;A.Writer=h;class se{constructor(e,t){this.template=e,this.state=t,this.ast=A.parse(e)}getValue(){return this.value===void 0&&(this.value=A.render(this.template,this.state)),this.value}onChange(e){const t=[];for(const s of this.getUsedVariables().values())t.push(this.state.onVariableChange(s).subscribe(()=>{const r=A.render(this.template,this.state);r!==this.value&&(this.value=r,e(this.value))}));return{unsubscribe:()=>{for(const s of t)s.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const e=new Set;return this.recursiveGetUsedVariables(this.ast,e),e}recursiveGetUsedVariables(e,t){for(const s of e){const r=s[0],n=s[1],o=s[4];["name","&","#","^"].includes(r)&&t.add(n),o!==void 0&&typeof o!="string"&&this.recursiveGetUsedVariables(o,t)}}}async function Me(){var a;const e=await fe();for(const t of e){const s=(a=t.properties)!==null&&a!==void 0?a:[];for(const r of s){if(r.type==="int"||r.type==="bool"||r.type==="object"||typeof r.value!="string")continue;const n=new se(r.value,WA.state);if(n.isPureString())continue;const o=n.getValue();await $(t.name,r.name,o),n.onChange(async i=>{await $(t.name,r.name,i)})}}}async function Ne(){var a;const e=await j();for(const[t,s]of e.entries())if(s.type!=="objectgroup"){const r=(a=s.properties)!==null&&a!==void 0?a:[];for(const n of r){if(n.type==="int"||n.type==="bool"||n.type==="object"||typeof n.value!="string")continue;const o=new se(n.value,WA.state);if(o.isPureString())continue;const i=o.getValue();Q(t,n.name,i),o.onChange(p=>{Q(t,n.name,p)})}}}async function $(a,e,t){console.log(a),(await WA.room.area.get(a)).setProperty(e,t)}function Q(a,e,t){WA.room.setProperty(a,e,t),e==="visible"&&(t?WA.room.showLayer(a):WA.room.hideLayer(a))}let D,J=0,U=0;function X(a){if(WA.state[a.name]){let e=a.properties.mustGetString("openLayer");for(const t of e.split(`
`))WA.room.showLayer(t);e=a.properties.mustGetString("closeLayer");for(const t of e.split(`
`))WA.room.hideLayer(t)}else{let e=a.properties.mustGetString("openLayer");for(const t of e.split(`
`))WA.room.hideLayer(t);e=a.properties.mustGetString("closeLayer");for(const t of e.split(`
`))WA.room.showLayer(t)}}function Ce(a){const e=a.properties.getString("openSound"),t=a.properties.getNumber("soundRadius");let s=1;if(t){const r=ne(a.properties.mustGetString("openLayer").split(`
`));if(r>t)return;s=1-r/t}e&&WA.sound.loadSound(e).play({volume:s})}function je(a){const e=a.properties.getString("closeSound"),t=a.properties.getNumber("soundRadius");let s=1;if(t){const r=ne(a.properties.mustGetString("closeLayer").split(`
`));if(r>t)return;s=1-r/t}e&&WA.sound.loadSound(e).play({volume:s})}function re(a){return a.map(e=>D.get(e)).filter(e=>(e==null?void 0:e.type)==="tilelayer")}function ne(a){const e=re(a),t=ae(e),s=((t.right-t.left)/2+t.left)*32,r=((t.bottom-t.top)/2+t.top)*32;return Math.sqrt(Math.pow(J-s,2)+Math.pow(U-r,2))}function xe(a){WA.state.onVariableChange(a.name).subscribe(()=>{WA.state[a.name]?Ce(a):je(a),X(a)}),X(a)}function Be(a,e,t,s){const r=a.name;let n,o,i=!1;const p=t.getString("tag");let f=!0;p&&!WA.player.tags.includes(p)&&(f=!1);const b=!!p;function W(){var c;n&&n.remove(),n=WA.ui.displayActionMessage({message:(c=t.getString("closeTriggerMessage"))!==null&&c!==void 0?c:"Press SPACE to close the door",callback:()=>{WA.state[e.name]=!1,P()}})}function P(){var c;n&&n.remove(),n=WA.ui.displayActionMessage({message:(c=t.getString("openTriggerMessage"))!==null&&c!==void 0?c:"Press SPACE to open the door",callback:()=>{WA.state[e.name]=!0,W()}})}function B(c){const S=ae(re(e.properties.mustGetString("closeLayer").split(`
`)));o=WA.room.website.create({name:"doorKeypad"+c,url:s+"/keypad.html#"+encodeURIComponent(c),position:{x:S.right*32,y:S.top*32,width:32*3,height:32*4},allowApi:!0})}function L(){o&&(WA.room.website.delete(o.name),o=void 0)}WA.room.onEnterLayer(r).subscribe(()=>{if(i=!0,t.getBoolean("autoOpen")&&f){WA.state[e.name]=!0;return}if(!WA.state[e.name]&&(b&&!f||!b)&&(t.getString("code")||t.getString("codeVariable"))){B(r);return}f&&(WA.state[e.name]?W():P())}),WA.room.onLeaveLayer(r).subscribe(()=>{i=!1,t.getBoolean("autoClose")&&(WA.state[e.name]=!1),n&&n.remove(),L()}),WA.state.onVariableChange(e.name).subscribe(()=>{i&&(!t.getBoolean("autoClose")&&WA.state[e.name]===!0&&W(),o&&WA.state[e.name]===!0&&L(),!t.getBoolean("autoOpen")&&WA.state[e.name]===!1&&P())})}function Ve(a){const e=a.properties.mustGetString("bellSound"),t=a.properties.getNumber("soundRadius");let s=1;if(t){const r=Math.sqrt(Math.pow(a.x-J,2)+Math.pow(a.y-U,2));if(r>t)return;s=1-r/t}WA.sound.loadSound(e).play({volume:s})}function Re(a){WA.state[a.name]===void 0&&(WA.state[a.name]=0),WA.state.onVariableChange(a.name).subscribe(()=>{WA.state[a.name]&&Ve(a)})}function Ge(a,e,t){let s;const r=e.getString("bellPopup");WA.room.onEnterLayer(t).subscribe(()=>{var n;r?s=WA.ui.openPopup(r,"",[{label:(n=e.getString("bellButtonText"))!==null&&n!==void 0?n:"Ring",callback:()=>{WA.state[a]=WA.state[a]+1}}]):WA.state[a]=WA.state[a]+1}),WA.room.onLeaveLayer(t).subscribe(()=>{s&&(s.close(),s=void 0)})}async function Oe(a){a=a??z;const e=await ue();D=await j();for(const t of e.values())t.properties.get("door")&&xe(t),t.properties.get("bell")&&Re(t);for(const t of D.values()){const s=new N(t.properties),r=s.getString("doorVariable");if(r&&t.type==="tilelayer"){const o=e.get(r);if(o===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of layer "'+t.name+'"');Be(t,o,s,a)}const n=s.getString("bellVariable");n&&Ge(n,s,t.name)}WA.player.onPlayerMove(t=>{J=t.x,U=t.y})}function De(a,e){const t=a.getString("bindVariable");if(t){const s=a.get("enterValue"),r=a.get("leaveValue"),n=a.getString("triggerMessage"),o=a.getString("tag");Ie(t,e,s,r,n,o)}}function Ie(a,e,t,s,r,n){n&&!WA.player.tags.includes(n)||(t!==void 0&&WA.room.onEnterLayer(e).subscribe(()=>{r||(WA.state[a]=t)}),s!==void 0&&WA.room.onLeaveLayer(e).subscribe(()=>{WA.state[a]=s}))}async function ze(){const a=await j();for(const e of a.values()){const t=new N(e.properties);De(t,e.name)}}let Y;async function Fe(a){const e=await WA.room.getTiledMap();a=a??z,Y=await j();const t=e.layers.find(s=>s.name==="configuration");if(t){const r=new N(t.properties).getString("tag");(!r||WA.player.tags.includes(r))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(a+"/configuration.html",!0)});for(const n of Y.values()){const o=new N(n.properties),i=o.getString("openConfig");i&&n.type==="tilelayer"&&Je(i.split(","),n.name,o)}}}function Je(a,e,t){let s;const r=t.getString("openConfigAdminTag");let n=!0;r&&!WA.player.tags.includes(r)&&(n=!1);function o(){var p;s&&s.remove(),s=WA.ui.displayActionMessage({message:(p=t.getString("openConfigTriggerMessage"))!==null&&p!==void 0?p:"Press SPACE or touch here to configure",callback:()=>H(a)})}function i(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(e).subscribe(()=>{const p=t.getString("openConfigTrigger");n&&(p&&p==="onaction"?o():H(a))}),WA.room.onLeaveLayer(e).subscribe(()=>{s&&s.remove(),i()})}function Ue(){return WA.onInit().then(()=>{Oe().catch(a=>console.error(a)),ze().catch(a=>console.error(a)),Fe().catch(a=>console.error(a)),Ne().catch(a=>console.error(a)),Me().catch(a=>console.error(a))}).catch(a=>console.error(a))}console.log("Script started successfully");let l=new Array,m={salles:[!1,!1,!1,!1,!1,!1,!1,!1,!1],conf1:[!1,!1,!1,!1,!1,!1,!1,!1,!1],conf2:[!1,!1,!1,!1,!1,!1,!1,!1,!1],conf3:[!1,!1,!1,!1,!1,!1,!1,!1,!1],indices:[!1,!1,!1,!1,!1,!1,!1,!1,!1],indicesTotaux:[!1,!1,!1,!1,!1,!1,!1,!1,!1],quetes:[!1,!1,!1,!1],quetesTot:[!1,!1,!1,!1],quetesTard:[!1,!1,!1,!1],quetesTotales:[!1,!1,!1,!1]};const I="Tom Pain";let M=0;WA.onInit().then(()=>{WA.ui.website.open({url:"src/planning.html",position:{vertical:"bottom",horizontal:"left"},size:{height:"17vh",width:"15vw"},margin:{bottom:"0vh"},allowApi:!0}),WA.player.state.foo=0,console.log("Scripting API ready"),console.log("Player tags: ",WA.player.tags),oe();function a(){var e=new Date,t=new Date;t.setHours(11),t.setMinutes(5),t.setSeconds(0);var s=new Date;s.setHours(12),s.setMinutes(45),s.setSeconds(0),e.getTime()===t.getTime()?WA.ui.banner.openBanner({id:"banner-test",text:"On va bientôt commencer, rendez-vous dans l'amphi ! :)",bgColor:"#0055FF",textColor:"#FFFFFF",closable:!1}):e.getTime()===s.getTime()&&_("C'est bientôt la fin... Rendez-vous dans l'amphi pour la conclusion !")}setInterval(a,1e3),WA.room.area.onEnter("StandS").subscribe(()=>{l.push(WA.ui.openPopup("StandS","Merci de vous rendre en salle 2 !",[{label:"OK !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("StandS").subscribe(u),WA.room.area.onEnter("StandConseil").subscribe(()=>{l.push(WA.ui.openPopup("StandConseil","Merci de vous rendre en salle 5 !",[{label:"OK !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("StandConseil").subscribe(u),WA.room.area.onEnter("indice1").subscribe(()=>{l.push(WA.ui.openPopup("indice1Popup","Bonjour ! Voici mon indice : 5 en chiffres Romain !",[{label:"OK !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("indice1").subscribe(u),WA.room.area.onEnter("indice2").subscribe(()=>{l.push(WA.ui.openPopup("indice2Popup","Hello ! Voici un nouvel indice : C'est la meilleure note possible à l'école !",[{label:"Merci !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("indice2").subscribe(u),WA.room.area.onEnter("indice3").subscribe(()=>{l.push(WA.ui.openPopup("indice3Popup","Un nouvel indice, ici tu trouveras : Mon 3eme est à la même place dans l'alphabet !",[{label:"Merci !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("indice3").subscribe(u),WA.room.area.onEnter("indice4").subscribe(()=>{l.push(WA.ui.openPopup("indice4Popup","Bonjour, voici mon indice : Je suis l'onomatopée préférée de Denis Brognard !",[{label:"OK, merci !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("indice4").subscribe(u),WA.room.area.onEnter("indice5").subscribe(()=>{l.push(WA.ui.openPopup("indice5Popup","Salut ! Allez, voici un petit indice : Je suis la première lettre du nom de notre entreprise !",[{label:"Merci !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("indice5").subscribe(u),WA.room.area.onEnter("indice6").subscribe(()=>{l.push(WA.ui.openPopup("indice6Popup","Bonjour ! Voici mon indice : Je suis l'initiale de la troisième valeur chez Néosoft !",[{label:"OK, merci !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("indice6").subscribe(u),WA.room.area.onEnter("indice7").subscribe(()=>{l.push(WA.ui.openPopup("indice7Popup","Hello ! Voici mon indice : Je suis imprimé sur la poitrine d'un super héros très connu !",[{label:"OK, merci !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("indice7").subscribe(u),WA.room.area.onEnter("indice8").subscribe(()=>{l.push(WA.ui.openPopup("indice8Popup","Hola ! Voici mon indice : Je suis la lettre la plus utilisée dans la langue française !",[{label:"OK, merci !",className:"primary",callback:()=>{u()}}]))}),WA.room.area.onLeave("indice8").subscribe(u),WA.room.area.onEnter("rs").subscribe(()=>{l.push(WA.ui.openPopup("rsPopup","Tu veux nous suivre sur les réseaux sociaux ?",[{label:"Linkedin",className:"primary",callback:e=>{WA.openTab("https://www.linkedin.com/company/neosoft_"),e.close()}},{label:"Twitter",className:"primary",callback:e=>{WA.openTab("https://twitter.com/neosoft_"),e.close()}}]))}),WA.room.area.onLeave("rs").subscribe(u),WA.room.area.onEnter("fdn").subscribe(()=>{l.push(WA.ui.openPopup("fdnPopup","Viens te sensibiliser aux enjeux du numérique !",[{label:"Je m'inscris à une fresque",className:"primary",callback:e=>{WA.openTab("https://landing.neosoft.fr/numerique-responsable"),e.close()}}]))}),WA.room.area.onLeave("fdn").subscribe(u),WA.room.area.onEnter("bot1").subscribe(()=>{d("quetesTard",0);let e;e=WA.player.state.foo,WA.player.state.foo=e,e==0?(l.push(WA.ui.openPopup("bot1Popup","Je sais qu'il y a un trésor dans le coin mais j'ai trop peur de l'eau.. Mon frère jumeau est parti bronzer au nord, tu pourrais y aller pour moi ?",[{label:"Bien sûr !",className:"primary",callback:()=>{u()}}])),WA.player.state.foo=e+1,console.log("test if : ",WA.player.state.foo)):(l.push(WA.ui.openPopup("bot1Popup","Je t'ai déjà dit d'aller à la piscine au nord !",[{label:"D'accord..",className:"primary",callback:()=>{u()}}])),console.log("test else : ",WA.player.state.foo))}),WA.room.area.onLeave("bot1").subscribe(u),WA.room.area.onEnter("bot2").subscribe(()=>{let e;e=WA.player.state.foo,WA.player.state.foo=e,e<1?(d("quetesTot",1),l.push(WA.ui.openPopup("bot2Popup","Laisse moi bronzer, tu veux bien ?",[{label:"Euuuh.. ok ?",className:"primary",callback:()=>{u()}}]))):e==1?(d("quetesTard",1),l.push(WA.ui.openPopup("bot2Popup","Un trésor ? Je n'en sais rien, essaye d'aller parler à mon cousin.. Je crois qu'il n'ose pas rentrer dans le labyrinthe, tu le trouveras là bas !",[{label:"Bien sûr !",className:"primary",callback:()=>{u()}}])),WA.player.state.foo=e+1):(d("quetesTard",1),l.push(WA.ui.openPopup("bot2Popup","Es-tu allé au labyrinthe ?",[{label:"Pas encore",className:"primary",callback:()=>{u()}}])))}),WA.room.area.onLeave("bot2").subscribe(u),WA.room.area.onEnter("bot3").subscribe(()=>{let e;e=WA.player.state.foo,WA.player.state.foo=e,e==2&&(d("quetesTard",2),l.push(WA.ui.openPopup("bot3Popup","Au Nord-Est tu iras, cette pelle tu prendras, et à la croix tu te rendras..",[{label:"Alors il existe ?",className:"primary",callback:()=>{u()}}])),WA.player.state.foo=e+1),e<2&&(d("quetesTot",2),l.push(WA.ui.openPopup("bot3Popup","Reviens plus tard...",[{label:"Ok",className:"primary",callback:()=>{u()}}]))),e>2&&(d("quetesTard",2),l.push(WA.ui.openPopup("bot3Popup","Bon, tu l'as récupéré ce trésor ?",[{label:"Non, pas encore",className:"primary",callback:()=>{u()}}])))}),WA.room.area.onLeave("bot3").subscribe(u),WA.room.area.onEnter("tresor").subscribe(()=>{let e;e=WA.player.state.foo,WA.player.state.foo=e,e<=2?(d("quetesTot",3),l.push(WA.ui.openPopup("tresorPopup1","Je me demande ce qu'il se cache ici.. Tiens un ticket de parking ? Peut être que quelqu'un l'a égaré ? Je ferai bien d'aller voir là bas..",[{label:"Fermer",className:"primary",callback:()=>{u()}}]))):(d("quetesTard",3),l.push(WA.ui.openPopup("tresorPopup1","Le trésor est.. le nom de ce fameux chanteur !",[{label:"Découvrir le trésor !",className:"primary",callback:()=>{WA.openTab("https://www.youtube.com/embed/dQw4w9WgXcQ?si=UvOTyPhvzyGRv-6r"),u()}}])))}),WA.room.area.onLeave("tresor").subscribe(u),Ue().then(()=>{console.log("Scripting API Extra ready")}).catch(e=>console.error(e))}).catch(a=>console.error(a));WA.room.onEnterLayer("mgZoneAdmin").subscribe(()=>{WA.player.name==I&&(l.push(WA.ui.openPopup("mgSalle1","salle 1",[{label:"ajouter",className:"primary",callback:()=>{y("salle 1,")}}])),l.push(WA.ui.openPopup("mgSalle2","salle 2",[{label:"ajouter",className:"primary",callback:()=>{y("salle 2,")}}])),l.push(WA.ui.openPopup("mgSalle3","salle 3",[{label:"ajouter",className:"primary",callback:()=>{y("salle 3,")}}])),l.push(WA.ui.openPopup("mgSalle4","salle 4",[{label:"ajouter",className:"primary",callback:()=>{y("salle 4,")}}])),l.push(WA.ui.openPopup("mgSalle5","salle 5",[{label:"ajouter",className:"primary",callback:()=>{y("salle 5,")}}])),l.push(WA.ui.openPopup("mgSalle6","salle 6",[{label:"ajouter",className:"primary",callback:()=>{y("salle 6,")}}])),l.push(WA.ui.openPopup("mgSalle7","salle 7",[{label:"ajouter",className:"primary",callback:()=>{y("salle 7,")}}])),l.push(WA.ui.openPopup("mgSalle8","salle 8",[{label:"ajouter",className:"primary",callback:()=>{y("salle 8,")}}])),l.push(WA.ui.openPopup("mgSalleAmphi","Amphi",[{label:"ajouter",className:"primary",callback:()=>{y("amphithéâtre,")}}])),l.push(WA.ui.openPopup("5min","5 minutes de retard",[{label:"ajouter",className:"primary",callback:()=>{y("5 minutes de retard.  ")}}])),l.push(WA.ui.openPopup("10min","10 minutes de retard",[{label:"ajouter",className:"primary",callback:()=>{y("10 minutes de retard.  ")}}])),l.push(WA.ui.openPopup("15min","15 minutes de retard",[{label:"ajouter",className:"primary",callback:()=>{y("15 minutes de retard.  ")}}])),l.push(WA.ui.openPopup("20min","20 minutes de retard",[{label:"ajouter",className:"primary",callback:()=>{y("20 minutes de retard.  ")}}])),l.push(WA.ui.openPopup("vasCommencer","debut de conference",[{label:"ajouter",className:"primary",callback:()=>{y("la conférence commenceras sous peu.  ")}}])),l.push(WA.ui.openPopup("admin","Envoyer",[{label:"envoyé",className:"primary",callback:()=>{_e()}}])),l.push(WA.ui.openPopup("mgSuppression","Supprimer",[{label:"supprimer",className:"primary",callback:()=>{He()}}])),l.push(WA.ui.openPopup("mgTest","preview",[{label:"preview",className:"primary",callback:()=>{_(WA.state.messGlob)}}])))});WA.room.area.onEnter("salle1Panneau").subscribe(()=>{l.push(WA.ui.openPopup("salle1Popup",`↑ Salle1 ↑ 
→ Salle 2 à 8 → 
← Salle Amphi ←`,[]))});WA.room.area.onLeave("salle1Panneau").subscribe(u);WA.room.area.onEnter("salle2Panneau").subscribe(()=>{l.push(WA.ui.openPopup("salle2Popup",`↑ Salle2 ↑ 
→ Salle 3 à 8 → 
← Salle 1 et Amphi ←`,[]))});WA.room.area.onLeave("salle2Panneau").subscribe(u);WA.room.area.onEnter("salle3Panneau").subscribe(()=>{l.push(WA.ui.openPopup("salle3Popup",`↑ Salle3 ↑ 
→ Salle 4 à 5 → 
← Salle 1 à 2 et Amphi ←
↓ Salle 6 à 8 ↓`,[]))});WA.room.area.onLeave("salle3Panneau").subscribe(u);WA.room.area.onEnter("salle4Panneau").subscribe(()=>{l.push(WA.ui.openPopup("salle4Popup",`↑ Salle4 ↑ 
→ Salle 5 → 
← Salle 1,2,3,8 et Amphi ←
↓ Salle 6 à 7 ↓`,[]))});WA.room.area.onLeave("salle4Panneau").subscribe(u);WA.room.area.onEnter("salle5Panneau").subscribe(()=>{l.push(WA.ui.openPopup("salle5Popup",`↑ Salle5 ↑ 
← Salle 1,2,3,4,8 et Amphi ←
↓ Salle 6 à 7 ↓`,[]))});WA.room.area.onLeave("salle5Panneau").subscribe(u);WA.room.area.onEnter("salle6Panneau").subscribe(()=>{l.push(WA.ui.openPopup("salle6Popup",`→ Salle 6 → 
↑ Salle 4,5 ↑ 
← Salle 1,2,3,4,8 et Amphi ←
↓ Salle 7 ↓`,[]))});WA.room.area.onLeave("salle6Panneau").subscribe(u);WA.room.area.onEnter("salle7Panneau").subscribe(()=>{l.push(WA.ui.openPopup("salle7Popup",`→ Salle 7 → 
↑ Salle 4 à 6 ↑ 
← Salle 1,2,3,4,8 et Amphi ←`,[]))});WA.room.area.onLeave("salle7Panneau").subscribe(u);WA.room.area.onEnter("salle8Panneau").subscribe(()=>{l.push(WA.ui.openPopup("salle8Popup",`→ Salle 3 à 7 → 
← Salle 1,2 et Amphi ←
↓ Salle 8 ↓`,[]))});WA.room.area.onLeave("salle8Panneau").subscribe(u);WA.room.area.onEnter("salleAPanneau").subscribe(()=>{l.push(WA.ui.openPopup("salleAPopup",`↑ Amphithéâtre ↑ 
→ Salle 1 à 8 → 
`,[]))});WA.room.area.onLeave("salleAPanneau").subscribe(u);WA.room.area.onEnter("salle1").subscribe(()=>{d("salles",1)});WA.room.area.onEnter("salle2").subscribe(()=>{d("salles",2)});WA.room.area.onEnter("salle3").subscribe(()=>{d("salles",3)});WA.room.area.onEnter("salle4").subscribe(()=>{d("salles",4)});WA.room.area.onEnter("salle5").subscribe(()=>{d("salles",5)});WA.room.area.onEnter("salle6").subscribe(()=>{d("salles",6)});WA.room.area.onEnter("salle7").subscribe(()=>{d("salles",7)});WA.room.area.onEnter("salle8").subscribe(()=>{d("salles",8)});WA.room.area.onEnter("amphi").subscribe(()=>{d("salles",0)});WA.room.area.onEnter("mgSalle6").subscribe(()=>{Ke()});WA.room.onLeaveLayer("mgZoneAdmin").subscribe(()=>{u()});function u(){l.forEach(a=>{a.close()}),l.splice(0,l.length)}function _(a){WA.ui.banner.openBanner({id:"banner",text:a,bgColor:"#FAB000",textColor:"#FFFFFF",closable:!0})}function oe(){WA.state.aAfficher&&(_(WA.state.messGlob),WA.player.name==I&&M!=1?M=M+1:WA.player.name==I&&M==1&&(M=0,WA.state.messGlob="votre attention: ",WA.state.aAfficher=!1)),setTimeout(oe,2e3)}function y(a){WA.state.messGlob=WA.state.messGlob+" "+a}function _e(){WA.state.aAfficher=!0}function He(){WA.state.messGlob="Votre attention:"}function d(a,e){let t=WA.state.loadVariable("statistique");if(t=JSON.parse(t),a=="indices")t.indicesTotaux[e]+=1,m.indices[e]||(m.indices[e]=!0,t.indices[e]+=1,t.indicesTotaux[e]+=1);else if(a=="quetesTot")t.quetesTotales[e]+=1,m.quetes[e]||(m.quetes[e]=!0,t.quetes[e]+=1),m.quetesTot[e]||(m.quetesTot[e]=!0,t.quetesTot[e]+=1);else if(a=="quetesTard")console.log(m),t.quetesTotales[e]+=1,m.quetes[e]||(t.quetes[e]+=1,m.quetes[e]=!0),m.quetesTard[e]||(m.quetesTard[e]=!0,t.quetesTard[e]+=1);else if(a=="salles"){var s=new Date,r=new Date,n=new Date,o=new Date,i=new Date;r.setHours(12),r.setMinutes(0),r.setSeconds(0),n.setHours(12),n.setMinutes(15),n.setSeconds(0),o.setHours(12),o.setMinutes(30),o.setSeconds(0),i.setHours(12),i.setMinutes(30),i.setSeconds(0),m.salles[e]||(t.salles[e]+=1,m.salles[e]=!0),s>r&&s<n?m.conf1[e]||(t.conf1[e]+=1,m.conf1[e]=!0):s>n&&s<o?m.conf2[e]||(t.conf2[e]+=1,m.conf2[e]=!0):s>o&&s<i&&(m.conf3[e]||(t.conf3[e]+=1,m.conf3[e]=!0))}else console.log("categorie non existante, statistique non modifié.");WA.state.saveVariable("statistique",JSON.stringify(t)),console.log("statistique : ",WA.state.statistique)}function Ke(){let a=WA.state.loadVariable("statistique");a=JSON.parse(a);let e=a.salles[0]+" sont allez en amphi, "+a.conf1[0]+" de midi à midi quinze, "+a.conf2[0]+" de midi quinze à midi trente, "+a.conf3[0]+` de midi trente à midi quarante-cinq. 
`;for(let t=1;t<a.salles.length;t++)e=e+a.salles[t]+" sont allez en salle "+t+", "+a.conf1[t]+" de midi à midi quinze, "+a.conf2[t]+" de midi quinze à midi trente, "+a.conf3[t]+` de midi trente à midi quarante-cinq. 
`;for(let t=0;t<a.indices.length;t++)e=e+a.indices[t]+" personnes sont allé voir le bot pour l'indice "+(t-1+2)+" et ont leur a adressé la paroles "+a.indicesTotaux[t]+` fois
`;for(let t=0;t<a.quetes.length;t++)e=e+"le bot numéro "+(t-1+2)+" de la quetes a parlé à "+a.quetes[t]+" personnes differentes et à parler un total de "+a.quetesTotales[t]+" fois. "+a.quetesTot[t]+" lui ont parlé trop tôt et "+a.quetesTard[t]+` ont recuperée son information
`;console.log(e)}
